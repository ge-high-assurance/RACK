# Counter Application Implementation

This directory contains a fake counter application implementation for
the Turnstile example to demonstrate the RACK ASSIST tool.  The build
process uses the ASSIST functionality to automatically generate FILE
and SOFTWARE namespace instances for the various components used in
and generated by the build process, as well as recording the build
tools used and users running the build.

## Setup and System Requirements

### Compatibility

ASSIST tooling is compatible with **Linux/Unix**.  Running in a native
Linux/Unix environment should present no difficulties.

#### Windows

If using Windows, the [Microsoft Windows Subsystem for
Linux](https://docs.microsoft.com/en-us/windows/wsl/install-win10) can
be used.  In addition, `dos2unix` may be needed to convert files in
DOS/MAC format to UNIX format and can be installed via the following
steps.
  
```shell
$ sudo apt-get update
$ sudo apt install dos2unix
``` 

Use the `dos2unix` utility to convert the following ASSIST utilities
to prevent error such as ```'\r': command not found```.

```shell
$ dos2unix ..<path-to>../assist/databin/make
$ dos2unix ..<path-to>../assist/databin/gcc
$ dos2unix ..<path-to>../assist/databin/rack_capture
$ dos2unix ..<path-to>../assist/databin/rackfuncs.sh
$ dos2unix ..<path-to>../assist/databin/tar
$ dos2unix ..<path-to>../assist/bin/ingest_data
```

### Prolog

Check that SWI Prolog is installed and is a minimum version of 8.x.

```shell
$ swipl --version
``` 

Prolog can be installed/updated on Debian/Ubuntu via the following
steps:

```shell
# You can skip adding ppa repo on Ubuntu 22.04 or later
$ sudo add-apt-repository ppa:swi-prolog/stable
$ sudo apt-get update
$ sude apt-get install swi-prolog
```

### Add to PATH

To set up for using the ASSIST tooling:

```shell
$ export PATH=..<path-to>../RACK/assist/databin:..<path-to>../RACK/assist/bin:$PATH
```

## Collecting Software Data

To capture the information about the build, files and tools involved,
and other elements, use the following
[ASSIST-DC](https://github.com/ge-high-assurance/RACK/tree/master/assist#assist-dc----data-collection)
tools:

```shell
$ cd ..<path-to>../RACK/Turnstile-Example/Turnstile-IngestionPackage/CounterApplicationImplementation
$ make clean
$ make
$ make test
$ make dist
```

During the execution of the above, a number of `.*.rack` files will be
created by ASSIST-DC to capture the information about the build
process and generated artifacts.  These files are normally not
visible, but may be seen with an `ls -a` command.

## Importing Software Data

To upload this data into the RACK instance, the `ingest_data` tool
(part of
[ASSIST-DI](https://github.com/ge-high-assurance/RACK/tree/master/assist#assist-di----data-ingestion])
can be run with the following arguments:

* location to the Turnstile-specific data extensions file
  `turnstile-ingest.rack`
* server address and port if other than http://localhost:3030/
* Turnstile data-graph location
* location to the directory containing ASSIST-DC data (i.e., the
  `.*.rack` files generated during the `make` operations above).

```shell
$ ingest_data \
    -r ../turnstile-ingest.rack \
    -o http://optionalserveraddr:port/ \
    http://rack001/turnstiledata 
    .
```

The `ingest_data` command can be run with no arguments to get help
usage data.

If run without the `turnstile-ingest.rack` supplemental data
recognizers then standard RACK Ontology elements will still be
created, but they will not be connected to the SADL or CSV-specified
abstract data elements such as Requirements.

The `ingest_data` can be run multiple times, and should be run at
least once after every set of `make` operations to ingest updated
information.
